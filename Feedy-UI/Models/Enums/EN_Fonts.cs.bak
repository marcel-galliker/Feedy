using GE_Utilities;
using System;
using System.Collections;
using System.Collections.Generic;
using System.Drawing;
using System.Drawing.Text;
using System.Text;
using System.Windows.Media;

namespace EZ_Editor.Models.Enums
{

    public class EN_Fonts : IEnumerable
    {
        private static List<GeEnum<string>> _List;

        //--- Constructor ----------------------------------------------------
        public EN_Fonts()
        {
            if (_List == null)
            {
                List<GeEnum<string>> list = new List<GeEnum<string>>();
                /*
                foreach(var source in Fonts.SystemFontFamilies)
                {
                    Console.WriteLine("System FontFamily: {0}", source.Source);
                }
                */
                StringBuilder fontname = new StringBuilder(64);
                InstalledFontCollection installedFontCollection = new InstalledFontCollection();
                foreach( var font in installedFontCollection.Families)
                {
                    /*
                    Console.WriteLine("Installed FontFamily: {0}", font.Name);
                    foreach(var source in Fonts.SystemFontFamilies)
                    {
                        if (source.Source.StartsWith(font.Name))
                        {
                            Console.WriteLine("Font: {0,-20} -> {1}", source.Source, font.Name);
                            list.Add(new GeEnum<string>(source.Source, font.Name));                
                        }
                    }
                    */
                    list.Add(new GeEnum<string>(font.Name, font.Name));
                }
                _List=list;
            }
        }

        //--- enumerator --------------------------------------------------------
        IEnumerator IEnumerable.GetEnumerator()
        {
            return (IEnumerator)new GeListEnumerator<GeEnum<string>>(_List);
        }
    }

    //--- BcFontList -------------------------------------------------------------

    public class BcFontList : IEnumerable
    {
        private static List<string> _List;

        public BcFontList()
        {
            if (_List == null)
            {
                _List = new List<string>();
                _List.Add("OCRB");
                _List.Add("");
            }
        }

        //--- enumerator ------------------------------------------------------
        IEnumerator IEnumerable.GetEnumerator()
        {
            return (IEnumerator)new GeListEnumerator<string>(_List);
        }
    }
}